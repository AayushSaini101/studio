# Migration `20200510162820-add-plans`

This migration has been generated by fmvilas at 5/10/2020, 4:28:20 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."organizations" ALTER COLUMN "plan_name" DROP DEFAULT;

ALTER TABLE "public"."users" ALTER COLUMN "plan_name" DROP DEFAULT;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200506152925-initial..20200510162820-add-plans
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model apis {
   asyncapi          String
@@ -22,9 +22,9 @@
 model invitations {
   createdAt       DateTime?     @default(now()) @map(name: "created_at")
   expiresAt       DateTime      @map(name: "expires_at")
-  id              Int           @default(autoincrement())
+  id              Int           @default(autoincrement()) @id
   inviterId       Int           @map(name: "inviter_id")
   organizationId  Int           @map(name: "organization_id")
   role            String
   scope           String?       @default("one")
@@ -38,12 +38,14 @@
   featureFlags                Json?                 @map(name: "feature_flags")
   id                          Int                   @default(autoincrement()) @id
   name                        String
   creatorId                   Int                   @map(name: "creator_id")
+  planName                    String?               @map(name: "plan_name")
   invitations                 invitations[]
   organizationUsers           organizationsUsers[]
   projects                    projects[]
   creator                     users                 @relation(fields: [creatorId], references: [id])
+  plan                        plans?                @relation(fields: [planName], references: [name])
 }
 model organizationsUsers {
   createdAt       DateTime?     @default(now()) @map(name: "created_at")
@@ -76,10 +78,17 @@
   email                String                @unique
   featureFlags         Json?                 @map(name: "feature_flags")
   id                   Int                   @default(autoincrement()) @id
   username             String                @unique
+  planName             String?               @map(name: "plan_name")
   apis                 apis[]
   invitations          invitations[]
   organizationsForUser organizationsUsers[]
   projects             projects[]
   organizations        organizations[]
+  plan                 plans?                @relation(fields: [planName], references: [name])
 }
+
+model plans {
+  name         String @unique
+  restrictions Json?
+}
```


